# 沙箱开发文档

该目录保存 uzoncalc 沙箱调用相关的逻辑

## 定位

应该有两套实现，一套是本地运行时，在进程内调用；另一套是远程调用时，通过docker容器部署后，远程调用。

两者的接口应该保持一致。

## 主要逻辑

用户通过 fastapi 提供的接口，传入脚本的路径和初始化参数，服务端负责加载脚本，执行脚本中的 @uzon_calc 装饰器装饰的函数
若函数中包含 UI 交互，则通过先返回一部分，然后等待用户输入后，将值传入某个接口，将函数恢复执行，直到函数执行完毕，返回完整结果。

调用时，要有超时和异常处理机制，防止脚本卡死、无限循环、用户中途不再调用等情况。
